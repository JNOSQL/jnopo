# JNopo Talk project

It's a project created for presentation purposes. This presentation intent to bring concepts and sample code regarding Jakarta NoSQL, Jakarta Data and Eclipse JNoSQL utilization;

This is a sample application generated by the Eclipse Foundation starter for Jakarta EE.


## Running the project

### Startup the required database

This application requires some NoSQL databases (they're described at `docker-compose.yml` file in the root dir in this project), so execute the command below to start up them:

```shell
docker-compose up -d
```

This `docker-compose.yml` is starting up two containers:
- a MongoDB - take a look at the `docker-compose.yml` file to realize what the localhost port it will be used. Default is: 27017;
- a Mongo Express - A web browser application to navigate on the database. Take a look at the `docker-compose.yml` file to realize what the localhost port it will be used. 
  Default is: 8081;

### Accessing the MongoDB Shell from the MongoDB instance 

If you want to execute mongo commands against the Mongodb, access the shell console by performing the follow command:

```shell
docker exec -it jnopo-talk_mongo_1 mongosh -u root -p example
```

### Execute the project in DEV mode

You can run the application by executing the following command from the directory where this file resides. Please ensure you have installed a [Java SE 8+ implementation](https://adoptium.net/?variant=openjdk8) appropriate for your Jakarta EE version and runtime choice (we have tested with Java SE 8, Java SE 11 and Java SE 17). Note, the [Maven Wrapper](https://maven.apache.org/wrapper/) is already included in the project, so a Maven install is not actually needed. You may first need to execute `chmod +x mvnw`.

```
./mvnw clean package wildfly:run
```

If you prefer to run the UI with redeployment support, please execute the following from this directory:

```
mvn wildfly:dev
```


Once the server is running, the source directories are monitored for changes. If required the sources will be compiled and the deployment may be redeployed.

Once the runtime starts, you can access the project at http://localhost:8080/jnopo-talk.


### Build it as Docker Image

You can also run the project via Docker. To build the Docker image, execute the following commands from the directory where this file resides. Please ensure you have installed a [Java SE 8+ implementation](https://adoptium.net/?variant=openjdk8) appropriate for your Jakarta EE version/runtime choice and [Docker](https://docs.docker.com/get-docker/) (we have tested with Java SE 8, Java SE 11 and Java SE 17). Note, the [Maven Wrapper](https://maven.apache.org/wrapper/) is already included in the project, so a Maven install is not actually needed. You may first need to execute `chmod +x mvnw`.

```
./mvnw clean package
docker build -t jnopo-talk:v1 .
```

You can then run the Docker image by executing:

```
docker run -it --rm -p 8080:8080 jnopo-talk:v1
```

Once the runtime starts, you can access the project at http://localhost:8080/jnopo-talk.


## Performing the results after the period of the game matches

On the terminal, connect to the MongoDB instance that the project is attached to and, inside of the target database (by default is `jnopo`) perform the following command:

```console
db.GameMatch.aggregate([
 { $match: { tied: { $eq: false }}},
 { $group: { _id: "$winner.player.name", total: { $sum: 1 }}},
 { $sort: { total: -1 }}
])
```

It should return the ranking of winners by total victories.


